from telegram import Update, InlineKeyboardMarkup, InlineKeyboardButton
from telegram.ext import Application, CommandHandler, ContextTypes

# –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
API_TOKEN = "7555314407:AAHaAfkCJD0YpQFEc1UCtzlnLW12GoS6HBY"

# URL –º–∏–Ω–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
WEB_APP_URL = "https://mars715.github.io/bizblog-webapp/"

# –ö–æ–º–∞–Ω–¥–∞ /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id
    user_name = update.effective_user.first_name

    # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Web App
    keyboard = [
        [
            InlineKeyboardButton(
                text="–û—Ç–∫—Ä—ã—Ç—å BizBlog",
                web_app={"url": WEB_APP_URL}
            )
        ]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π
    await context.bot.send_message(
        chat_id=chat_id,
        text=f"üëã –ü—Ä–∏–≤–µ—Ç, {user_name}! –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.",
        reply_markup=reply_markup
    )

# –ö–æ–º–∞–Ω–¥–∞ /role –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–µ–π
async def role(update: Update, context: ContextTypes.DEFAULT_TYPE):
    chat_id = update.effective_chat.id

    # –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ä–æ–ª–∏
    keyboard = [
        [
            InlineKeyboardButton("–Ø –ë–ª–æ–≥–µ—Ä", callback_data="blogger"),
            InlineKeyboardButton("–Ø –†–µ–∫–ª–∞–º–æ–¥–∞—Ç–µ–ª—å", callback_data="advertiser"),
        ]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)

    # –°–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏
    await context.bot.send_message(
        chat_id=chat_id,
        text="–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ, –∫—Ç–æ –≤—ã:",
        reply_markup=reply_markup
    )

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
def main():
    application = Application.builder().token(API_TOKEN).build()

    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CommandHandler("role", role))

    # –ó–∞–ø—É—Å–∫ polling
    application.run_polling()

if __name__ == "__main__":
    main()
